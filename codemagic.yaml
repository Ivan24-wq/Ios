workflows:
  ios-unsigned:
    name: Build unsigned iOS IPA (.NET MAUI)
    max_build_duration: 60
    environment:
      xcode: latest
    scripts:
      - name: Install .NET 9 SDK
        script: |
          wget https://download.visualstudio.microsoft.com/download/pr/3ef99172-8c1e-4f69-b3a8-4db5a6a4d3f1/1db0f47e87b2c1fc2f29b93b25bb8324/dotnet-sdk-9.0.100-osx-arm64.tar.gz -O dotnet.tar.gz
          sudo mkdir -p /usr/share/dotnet
          sudo tar -zxf dotnet.tar.gz -C /usr/share/dotnet
          export DOTNET_ROOT=/usr/share/dotnet
          export PATH=$DOTNET_ROOT:$PATH
          dotnet --version
      - name: Install MAUI workloads
        script: |
          dotnet workload install maui-ios
      - name: Restore NuGet packages
        script: |
          dotnet restore YourList.csproj
      - name: Build unsigned IPA
        script: |
          dotnet publish YourList.csproj \
            -f net9.0-ios \
            -c Release \
            -o ./output/ios \
            /p:BuildIpa=true \
            /p:EnableCodeSigning=false \
            /p:RuntimeIdentifier=ios-arm64
    artifacts:
      - output/ios/**/*.ipa
